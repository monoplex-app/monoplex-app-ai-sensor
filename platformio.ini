; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

[env:esp32-s3-devkitc-1]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
monitor_speed = 115200
upload_speed = 921600
lib_deps = 
	PubSubClient
	adafruit/Adafruit VCNL4040@^1.2.0
	sparkfun/SparkFun BMI270 Arduino Library@^1.0.3
	bblanchon/ArduinoJson@^7.4.1
board_build.filesystem = littlefs
board_build.arduino.memory_type = qio_opi # ESP32-S3 DevKitC-1 (N8R8 또는 N16R8)은 보통 OPI PSRAM을 사용합니다.
                                        # 사용 중인 모듈의 정확한 스펙을 확인하세요 (N8R2 모델은 PSRAM이 없을 수 있습니다).
                                        # 만약 PSRAM이 없는 모델이라면 이 줄과 아래 PSRAM 관련 플래그는 효과가 없습니다.
board_flags =
    -DBOARD_HAS_PSRAM
    -mextmem
    -DCONFIG_MBEDTLS_EXTERNAL_MEM_ALLOC=y   # MbedTLS가 외부 메모리(PSRAM) 사용 시도
    # -DCONFIG_MBEDTLS_MEM_ALLOC_MODE_EXTERNAL=y # 최신 ESP-IDF에서 사용될 수 있는 플래그
    # -DCONFIG_MBEDTLS_SSL_MAX_CONTENT_LEN=4096 # 필요시 SSL 버퍼 크기 조정 (기본 16KB)
    -DCONFIG_BT_NIMBLE_MAX_CONNECTIONS=1
    -DCONFIG_NIMBLE_CPP_LOG_LEVEL=0
    # -DCONFIG_ESP32_WIFI_RX_BUFFER_NUM=6
    # -DCONFIG_ESP32_WIFI_TX_BUFFER_NUM=6
    # -DCONFIG_ESP32_WIFI_DYNAMIC_RX_BUFFER_NUM=8
    # -DCONFIG_ESP32_WIFI_STATIC_RX_BUFFER_NUM=4
    -DCONFIG_ESP_COREDUMP_ENABLE=0
board_build.partitions = partitions.csv
